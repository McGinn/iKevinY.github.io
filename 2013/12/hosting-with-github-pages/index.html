<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Metas
	================================================== -->
	<meta charset="utf-8">
	<title>Hosting With GitHub&nbsp;Pages | Kevin Yap</title>
	<meta name="description" content="">
	<meta name="author" content="Kevin Yap">

	<!-- Open Graph
	================================================== -->
		<meta property="og:image" content="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=256">

	<meta property="og:title" content="Hosting With GitHub&nbsp;Pages | Kevin Yap">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://kevinyap.ca">
	<meta property="og:description" content="">
	<meta property="og:article:published_time" content="2013-12-07 00:00:00">
	<meta property="og:article:author" content="Kevin Yap">

	<!-- Mobile Specific Metas
	================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
	================================================== -->
	<link rel="stylesheet" href="http://kevinyap.ca/theme/base.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/skeleton.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/layout.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/simply.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/monokai.css">
	<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>
	<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Favicons
	================================================== -->
	<link rel="apple-touch-icon" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=512"> 								<!-- Universal -->
	<link rel="apple-touch-icon" sizes="57x57" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=57"> 		<!-- iPhone -->
	<link rel="apple-touch-icon" sizes="72x72" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=72"> 		<!-- iPad -->
	<link rel="apple-touch-icon" sizes="76x76" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=76"> 		<!-- iPad, iOS 7 -->
	<link rel="apple-touch-icon" sizes="114x114" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=114"> <!-- iPhone, Retina -->
	<link rel="apple-touch-icon" sizes="120x120" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=120"> <!-- iPhone, Retina iOS 7 -->
	<link rel="apple-touch-icon" sizes="144x144" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=144"> <!-- iPad, Retina -->
	<link rel="apple-touch-icon" sizes="152x152" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=152"> <!-- iPad, Retina iOS 7 -->

	<!-- LaTeX
	================================================== -->

</head>

<body>

	<!-- Primary Page Layout
	================================================== -->
	<div class="container">
		<div id="sidebar" class="three columns">
			<a href="http://kevinyap.ca"><img id="avatar" src="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=280"></img></a>
			<p id="logo"><a href="http://kevinyap.ca">Kevin Yap</a></p>
			<p id="bio">Developer and musician from Vancouver, BC.</p>
				<hr class="small" />
				<div id="social">
					<a class="icon" href="m&#97;&#105;l&#116;o&#58;me&#64;&#107;e&#118;inya%7&#48;&#46;ca" title="Email"><i class="fa fa-envelope-o"></i></a>
					<a class="icon" href="http://twitter.com/iKevinY" title="Twitter"><i class="fa fa-twitter"></i></a>
					<a class="icon" href="http://plus.google.com/+KevinYapCA" title="Google+"><i class="fa fa-google-plus"></i></a>
					<a class="icon" href="http://github.com/iKevinY" title="GitHub"><i class="fa fa-github"></i></a>
					<a class="icon" href="http://soundcloud.com/iKevinY" title="SoundCloud"><i class="fa fa-music"></i></a>
					<a class="icon" href="http://kevinyap.ca/feed.rss" title="RSS Feed"><i class="fa fa-rss"></i></a>
				</div> <!-- social -->
		</div> <!-- sidebar -->

		<section id="content" class="twelve columns offset-by-one">

	<h1 class="article-title"><a href="/2013/12/hosting-with-github-pages/" title="Permalink to Hosting With GitHub&nbsp;Pages">Hosting With GitHub&nbsp;Pages</a></h1>
	<h6 class="article-date">December 07, 2013</h6>
	<div class="article-content"><p>Over the past couple of days, I made the switch to using GitHub as the hosting platform for my website by using <a href="http://pages.github.com">GitHub Pages</a>. This felt like a natural progression as I already used GitHub for version control for the source of my website. I initially thought the move would be confusing and time-consuming, but after the <span class="caps">DNS</span> changes propagated, everything was up and running just as it had been before the&nbsp;move.</p>
<p>When dealing with User Pages with GitHub Pages, the hosted files must be located in the <code>master</code> branch of the repository. Since I didn&#8217;t want to have separate repositories for the source of the website and for the generated files, I opted to make an orphaned branch named <code>src</code> which would contain the source files. While I thought this would be complicated, it turned out to be quite&nbsp;straightforward.</p>
<p>Within the root directory of my website&#8217;s source, there is an <code>output</code> directory that the static site files generated by <a href="http://getpelican.com">Pelican</a> go. Prior to using GitHub Pages, I had written a Bash script that would run the <code>pelican</code> command to generate the static site files and upload them using <a href="http://en.wikipedia.org/wiki/Rsync">rsync</a>. Obviously, this script had to be rewritten, as in order to use GitHub Pages, changes need to be pushed to a Git repository rather than being uploaded to a web&nbsp;server.</p>
<p>To accomplish this, there are two Git repository: one in the root directory of my website&#8217;s source and one in the output directory. Both remotes are configured to push to the same remote repository stored on GitHub. The local repository in the root directory has the <code>output/</code> directory in its <code>.gitignore</code> file and commits to the <code>src</code> branch while the <code>output/</code> repository commits to the <code>master</code> branch. While they are technically part of the same remote repository, each local repository is completely separate from the&nbsp;other.</p>
<p>I created an <span class="caps">SSH</span> key so that I do not have to manually authenticate every time <code>git push</code> is run by my site generation script. (Also because I have two-factor authentication enabled on my GitHub account.) While this did not work initially, it turns out that I was using the wrong remote <span class="caps">URL</span>; the proper <span class="caps">URL</span> to use over <span class="caps">SSH</span> (which in retrospect is quite obvious) is <code>ssh://git@github.com:user/repo.git</code>, rather than the <span class="caps">HTTPS</span> <span class="caps">URL</span> that is shown by default on the right side of the page when browsing the repository on&nbsp;GitHub.</p>
<p>While I use <a href="http://mac.github.com">GitHub for Mac</a> to manage the repository for the source files (the <code>src</code> branch), the repository for the <code>output/</code> directory is only modified by the site generation script. Making use of <a href="https://help.github.com/articles/github-flavored-markdown">GitHub Flavoured Markdown</a>, the commit messages in the <code>master</code> branch contain links to the most recent commit in the <code>src</code> branch. When viewing the <code>master</code> branch on GitHub, the <a href="http://en.wikipedia.org/wiki/SHA-1"><span class="caps">SHA</span> hashes</a> automagically link to the corresponding commits in the <code>src</code> branch that generated the changes in the static site files, making it easy to determine what changes in the source files led to changes in the generated&nbsp;files.</p>
<p>To achieve this, the script runs the following code after the <code>pelican</code> command generates the static site&nbsp;files.</p>
<div class="highlight"><pre><span class="nb">cd</span> <span class="nv">$sourceDirectory</span>
<span class="nv">commitHash</span><span class="o">=</span><span class="k">$(</span>git rev-parse <span class="caps">HEAD</span><span class="k">)</span>
<span class="nb">cd</span> <span class="nv">$outputDirectory</span>
git checkout master
git add -A
<span class="nb">read</span> -p <span class="s2">&quot;Extended commit message: &quot;</span> commitMessage
<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;$commitMessage&quot;</span> <span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>git commit -m <span class="s2">&quot;Generated by $commitHash&quot;</span>
<span class="k">else</span>
<span class="k">    </span>git commit -m <span class="s2">&quot;Generated by $commitHash&quot;</span> -m <span class="s2">&quot;$commitMessage&quot;</span>
<span class="k">fi</span>
git push
</pre></div>


<p>The command <code>git rev-parse HEAD</code> returns the hash of the last commit in the Git repository&#8217;s history and is stored in the variable <code>$commitHash</code>. The directory is then changed to <code>output/</code> and <code>git checkout</code> is run to ensure the branch that changes will be committed to is the <code>master</code> branch (not that it <em>should</em> change, but in case I were to accidentally change branches manually, this would prevents anything problematic from happening). Any changes made are then added via <code>git add -A</code>.</p>
<p>Following this, the script prompts for an extended commit message (what gets shown on GitHub after expanding the message). The first line of the commit message is &#8220;Generated by&#8221; followed by the hash of the last commit made in the <code>src</code> branch, and if an extended commit message is provided, the script will add it in. Finally, the commit is pushed to the <code>master</code> branch on&nbsp;GitHub.</p>
<p>All in all, this solution seems to work very well. I would highly recommend using GitHub Pages for static&nbsp;sites.</p></div>
	<div class="related-articles">
	    <a href="http://kevinyap.ca/2013/07/the-great-white-pelican-migration/" style="float: right;">The Great (White) Pelican&nbsp;Migration →</a>
	</div>
	<hr class="large">

	<!-- Disqus -->
		<div id="disqus_thread"></div>
		<script type="text/javascript">
			var disqus_shortname = 'kevinyap';
				(function() {
					var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
					dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
					(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
				})();
		</script>
		<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
		<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

		</section>

		<footer class="twelve columns offset-by-one">
			<p>Powered by <a href="http://getpelican.com">Pelican</a>. Designed by <a href="http://www.gregreda.com/">Greg&nbsp;Reda</a>. Hosted with <a href="http://pages.github.com">GitHub&nbsp;Pages</a>.</p>
		</footer>

	</div><!-- container -->

		<!-- Google Analytics -->
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-41937659-1', '');
			ga('send', 'pageview');
		</script>


</body>
</html>