<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>

	<!-- Basic Metas
	================================================== -->
	<meta charset="utf-8">
	<title>Hosting With GitHub&nbsp;Pages | Kevin Yap</title>
	<meta name="description" content="">
	<meta name="author" content="Kevin Yap">

	<!-- Open Graph
	================================================== -->
		<meta property="og:image" content="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=256">

	<meta property="og:title" content="Hosting With GitHub&nbsp;Pages | Kevin Yap">
	<meta property="og:type" content="article">
	<meta property="og:url" content="http://kevinyap.ca">
	<meta property="og:description" content="">
	<meta property="og:article:published_time" content="2013-12-07 00:00:00">
	<meta property="og:article:author" content="Kevin Yap">

	<!-- Mobile Specific Metas
	================================================== -->
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<!-- CSS
	================================================== -->
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/base.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/skeleton.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/layout.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/simply.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/monokai.css">
	<link rel="stylesheet" href="http://kevinyap.ca/theme/css/font-awesome.css">
	<link href='http://fonts.googleapis.com/css?family=Source+Code+Pro' rel='stylesheet' type='text/css'>

	<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->

	<!-- Favicons
	================================================== -->
	<link rel="apple-touch-icon" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=512"> 								<!-- Universal -->
	<link rel="apple-touch-icon" sizes="57x57" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=57"> 		<!-- iPhone -->
	<link rel="apple-touch-icon" sizes="72x72" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=72"> 		<!-- iPad -->
	<link rel="apple-touch-icon" sizes="76x76" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=76"> 		<!-- iPad, iOS 7 -->
	<link rel="apple-touch-icon" sizes="114x114" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=114"> <!-- iPhone, Retina -->
	<link rel="apple-touch-icon" sizes="120x120" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=120"> <!-- iPhone, Retina iOS 7 -->
	<link rel="apple-touch-icon" sizes="144x144" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=144"> <!-- iPad, Retina -->
	<link rel="apple-touch-icon" sizes="152x152" href="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=152"> <!-- iPad, Retina iOS 7 -->

	<!-- LaTeX
	================================================== -->

</head>

<body>

	<!-- Primary Page Layout
	================================================== -->
	<div class="container">
		<div id="sidebar" class="three columns">
			<a href="http://kevinyap.ca"><img id="avatar" src="http://www.gravatar.com/avatar/0d1d263a229548db35dffba8c55e19f7?s=280"></img></a>
			<p id="logo"><a href="http://kevinyap.ca">Kevin Yap</a></p>
			<p id="bio">Developer and musician from Vancouver, BC.</p>
				<hr class="small" />
				<div id="social">
					<a class="icon" href="m&#97;&#105;l&#116;o&#58;me&#64;&#107;e&#118;inya%7&#48;&#46;ca" title="Email"><i class="icon-envelope"></i></a>
					<a class="icon" href="http://twitter.com/iKevinY" title="Twitter"><i class="icon-twitter"></i></a>
					<a class="icon" href="http://plus.google.com/110479238274720428388" title="Google+"><i class="icon-google-plus"></i></a>
					<a class="icon" href="http://github.com/iKevinY" title="GitHub"><i class="icon-github"></i></a>
					<a class="icon" href="http://soundcloud.com/iKevinY" title="SoundCloud"><i class="icon-music"></i></a>
					<a class="icon" href="http://kevinyap.ca/feed.rss" title="RSS Feed"><i class="icon-rss"></i></a>
				</div> <!-- social -->
		</div> <!-- sidebar -->

		<section id="content" class="twelve columns offset-by-one">

	<h1 class="article-title"><a href="/2013/12/hosting-with-github-pages/" title="Permalink to Hosting With GitHub&nbsp;Pages">Hosting With GitHub&nbsp;Pages</a></h1>
	<h6 class="article-date">December 07, 2013</h6>
	<div class="article-content"><p>This week, I made the switch to using GitHub as both version control for the source of my website but also as its hosting platform through <a href="http://pages.github.com">GitHub Pages</a>. I initially thought the move would be confusing and time-consuming, but after the <span class="caps">DNS</span> changes propagated, everything was running fine with only a few minutes of&nbsp;downtime.</p>
<p>There are two different types of GitHub Pages: User (or Organization) Pages and Project Pages. Being my personal website and blog, this website is a User Page hosted from the repository <code>iKevinY/iKevinY.github.io</code>. For User Pages, the content that is hosted must be located in the <code>master</code> branch of the <code>*.github.io</code> repository. Since I didn&#8217;t want to have two separate repositories for the source of the website and the generated files, I opted to make a branch, <code>src</code>, containing the source files. While I thought this would be complicated, it wasn&#8217;t all too&nbsp;difficult.</p>
<p>Within the root directory of my website&#8217;s source, there is an <code>output</code> directory that the static site files generated by <a href="http://getpelican.com">Pelican</a> go. Prior to using GitHub Pages, I had written a Bash script titled <code>generate.sh</code> that would upload the <code>output</code> directory to the web server using rsync. Obviously, this script had to be rewritten as in order to update my website through GitHub Pages, commits need to be pushed to the <code>master</code> branch of <code>iKevinY.github.io</code> instead of files being&nbsp;uploaded.</p>
<p>To accomplish this, there is a Git repository in the root directory and also in the output directory, and both remotes are configured to push to <code>iKevinY.github.io</code>. The local repository in the root directory has the <code>output</code> directory in its <code>.gitignore</code> file and commits to the <code>src</code> branch, while the <code>output</code> repository commits to the <code>master</code> branch.</p>
<p>To streamline the upload process, I created an <span class="caps">RSA</span> key-pair so that I would not have to manually authenticate every time <code>git push</code> was called by the upload script. While this did not work initially, it turns out that I was using the wrong remote <span class="caps">URL</span>; the proper <span class="caps">URL</span> to use over <span class="caps">SSH</span> (which in retrospect is quite obvious) is <code>ssh://git@github.com:[username]/[repository].git</code> instead of the <span class="caps">HTTPS</span> clone <span class="caps">URL</span> that is shown by default on the right side of the page when browsing the repository through&nbsp;GitHub.</p>
<p>After having set up the remote branch for the <code>output</code> directory&#8217;s repository, it is only modified by <code>generate.sh</code>. Making use of <a href="https://help.github.com/articles/github-flavored-markdown">GitHub Flavoured Markdown</a>, the commits from the <code>output</code> directory (that get pushed to the <code>master</code> branch) contain a commit message that references the most recent commit to the <code>src</code> branch. When viewing the <code>master</code> branch on GitHub, the <span class="caps">SHA</span> hashes link to the corresponding commits in the <code>src</code> branch that generated the changes in the static site files to make it easy to determine what the cause of any problems&nbsp;was.</p>
<p>To achieve this, the following code is run in <code>generate.sh</code> after the <code>pelican</code> command is run to generate the site&nbsp;files.</p>
<div class="highlight"><pre><span class="nb">cd</span> <span class="o">[</span>site <span class="nb">source </span>directory<span class="o">]</span>
<span class="nv">commitHash</span><span class="o">=</span><span class="k">$(</span>git rev-parse <span class="caps">HEAD</span><span class="k">)</span>
<span class="nb">cd</span> <span class="o">[</span>output directory<span class="o">]</span>
git checkout master
git add -A
<span class="nb">read</span> -p <span class="s2">&quot;Enter extended commit message: &quot;</span> commitMessage
<span class="k">if</span> <span class="o">[</span> -z <span class="s2">&quot;$commitMessage&quot;</span><span class="o">]</span>; <span class="k">then</span>
<span class="k">    </span>git commit -m <span class="s2">&quot;Generated by $commitHash&quot;</span>
<span class="k">else</span>
<span class="k">    </span>git commit -m <span class="s2">&quot;Generated by $commitHash&quot;</span> -m <span class="s2">&quot;$commitMessage&quot;</span>
<span class="k">fi</span>
git push
</pre></div>


<p>The command <code>git rev-parse HEAD</code> returns the <span class="caps">SHA</span> hash of the last commit in the Git repository&#8217;s history, and is stored in the variable <code>commitHash</code>. The directory is then changed to the <code>output</code> directory and <code>git checkout</code> is run to ensure the branch that changes will be committed to is the <code>master</code> branch (not that it should change, but this is more of a failsafe to ensure no problems occur). Any changes are then added via <code>git add -A</code>.</p>
<p>Following this, the script prompts for an extended commit message (what is shown on GitHub after expanding the commit message with the <code>…</code> button). The first line of the commit message is &#8220;Generated by&#8221; followed by the hash of the last commit made in the <code>src</code> branch, and if an extended commit message is provided, the script will add it in. Finally, the commit is pushed to&nbsp;GitHub.</p>
<p>All in all, this solution seems to work&nbsp;flawlessly.</p></div>

	<a href="https://twitter.com/share" class="twitter-share-button" data-via="iKevinY" data-count="none">Tweet</a>
	<div class="g-plusone" data-size="medium" data-annotation="none" data-width="300"></div>
	<div class="back-to-home"><a href="http://kevinyap.ca">← Back to Home</a></div>
	<hr class="large">
		
	<!-- Disqus -->

	<!-- Twitter -->
	<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

	<!-- Google+ -->
	<script type="text/javascript">
		(function() {
			var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
			po.src = 'https://apis.google.com/js/plusone.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
		})();
	</script>

		</section>

		<footer class="twelve columns offset-by-one">
			<p>Powered by <a href="http://getpelican.com">Pelican</a>. Designed by <a href="http://www.gregreda.com/">Greg&nbsp;Reda</a>. Hosted with <a href="http://pages.github.com">GitHub&nbsp;Pages</a>.</p>
		</footer>

	</div><!-- container -->

		<!-- Google Analytics -->
		<script>
			(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

			ga('create', 'UA-41937659-1', '');
			ga('send', 'pageview');
		</script>


</body>
</html>